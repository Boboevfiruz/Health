"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2782],{98284:function(e,t,r){r.d(t,{yr:function(){return O},Wx:function(){return y},sc:function(){return b}});var n=r(30266),o=r(92809),u=r(809),c=r.n(u),a=r(83109),i=r(34118),s=r(24308),p=r(58268);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d=function(e,t,r,n){return(0,s.CI)(e,t,"Session",function(e){return"ID={".concat(e.id,"}&Time=").concat(e.time)}(r),l({encode:String},n))},v=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"en";(0,s.CI)(e,t,a.AuthTokenType.Guest,"{".concat(r.id,"}"),l(l({encode:String},n),{},{domain:(0,p.PM)(o)}))},b=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"en";(0,s.CI)(e,t,"AudienceType",r,{encode:String,domain:(0,p.PM)(n),path:"/"})},y=function(e,t){for(var r=0,n=Object.values(a.AuthTokenType);r<n.length;r++){var o=n[r];(0,s.hl)(e,t,o)}},O=function(e){return function(){var t=(0,n.Z)(c().mark((function t(r,o,u,a,s){var p,f,l;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return p=null,f=a?{domain:a}:{},l=function(){var t=(0,n.Z)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.get("auth",{params:{lan:u,bot:Boolean(s)}});case 2:if(t.t0=t.sent.data,t.t0){t.next=5;break}t.t0=null;case 5:return t.abrupt("return",t.t0);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t.prev=3,t.next=6,l();case 6:p=t.sent,t.next=15;break;case 9:return t.prev=9,t.t0=t.catch(3),y(r,o),t.next=14,l();case 14:p=t.sent;case 15:if(p){t.next=17;break}throw new Error("Could not retrieve auth info");case 17:return d(r,o,p.session,f),(0,i.b)(r)||v(r,o,p.session,f),t.abrupt("return",p);case 20:case"end":return t.stop()}}),t,null,[[3,9]])})));return function(e,r,n,o,u){return t.apply(this,arguments)}}()}},89584:function(e,t,r){r.d(t,{dv:function(){return c},Xq:function(){return a},_R:function(){return i}});var n=r(30266),o=r(809),u=r.n(o),c=function(e){return(0,n.Z)(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.get("cart");case 2:return t.abrupt("return",t.sent.data);case 3:case"end":return t.stop()}}),t)})))},a=function(e){return function(){var t=(0,n.Z)(u().mark((function t(r){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.post("cart",r);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},i=function(e){return function(){var t=(0,n.Z)(u().mark((function t(r){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.post("cart/checkout",r);case 2:return t.abrupt("return",t.sent.data);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},34629:function(e,t,r){r.d(t,{S:function(){return s},U:function(){return p}});var n=r(92809),o=r(30266),u=r(809),c=r.n(u);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var s=function(e){return function(){var t=(0,o.Z)(c().mark((function t(r,n){var o,u=arguments;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=!(u.length>2&&void 0!==u[2])||u[2],t.next=3,e.get("licences/".concat(r,"?lan=").concat(n),i({},o?{}:{validateStatus:null}));case 3:return t.abrupt("return",t.sent.data);case 4:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()},p=function(e){return function(){var t=(0,o.Z)(c().mark((function t(r){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.post("purchase",r);case 2:return t.abrupt("return",t.sent.data);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},14464:function(e,t,r){r.d(t,{RK:function(){return c},S7:function(){return a},Rg:function(){return i}});var n=r(30266),o=r(809),u=r.n(o),c=function(e){return(0,n.Z)(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.get("lightboxes");case 2:return t.abrupt("return",t.sent.data.items);case 3:case"end":return t.stop()}}),t)})))},a=function(e){return function(){var t=(0,n.Z)(u().mark((function t(r,n){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.post("lightboxes/".concat(r.id),{seq:n.altids.seq,productType:n.type});case 2:return t.abrupt("return",t.sent.data);case 3:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()},i=function(e){return function(){var t=(0,n.Z)(u().mark((function t(r,n){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.post("lightboxes",{name:r,seq:n.altids.seq,productType:n.type});case 2:return t.abrupt("return",t.sent.data);case 3:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()}},56778:function(e,t,r){r.d(t,{r:function(){return c}});var n=r(30266),o=r(809),u=r.n(o),c=function(e){return(0,n.Z)(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.get("utility/layout");case 2:return t.abrupt("return",t.sent.data);case 3:case"end":return t.stop()}}),t)})))}},40370:function(e,t,r){r.d(t,{eM:function(){return x},yx:function(){return k}});var n=r(61565),o=r(30266),u=r(809),c=r.n(u),a=r(9669),i=r.n(a),s=r(25934),p=(r(25892),null),f=function(){var e=(0,o.Z)(c().mark((function e(){var t,o,u,a,i,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!p){e.next=2;break}return e.abrupt("return",p);case 2:return e.next=4,Promise.all([Promise.all([r.e(8501),r.e(4726)]).then(r.t.bind(r,8501,23)),Promise.all([r.e(8501),r.e(2326)]).then(r.t.bind(r,79267,23))]);case 4:return t=e.sent,o=(0,n.Z)(t,2),u=o[0],a=o[1],i=new u.Agent({keepAlive:!0,maxSockets:500}),s=new a.Agent({keepAlive:!0,maxSockets:500}),p=p||[i,s],e.abrupt("return",[i,s]);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=r(34118),d=r(92809),v=r(59289);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){(0,d.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var O=function(e,t){var r=y(y({},(0,v.De)(t)),e.headers||{});return y(y({},e),{},{headers:r})};function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){(0,d.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var w=function(e){var t,r=null===e||void 0===e||null===(t=e.url)||void 0===t?void 0:t.split("?");return r&&r[0]&&!r[0].endsWith("/")?g(g({},e),{},{url:r[1]?"".concat(r[0],"/?").concat(r[1]):"".concat(r[0],"/")}):e},j=r(485),P=function(e){return function(t){return O(t,{"x-geoip-country":e.headers["x-geoip-country"],"x-geoip-city":e.headers["x-geoip-city"],"x-forwarded-for":(0,j.I_)(e),"x-forwarded-host":e.headers["x-forwarded-host"]||e.headers.host})}},x=function(e,t,r){var n=r?"/search-api/":"/aggregator-api/";var o=i().create({baseURL:n});return o.interceptors.request.use(function(e){return function(t){return O(t,{"x-correlation-id":e})}}(t)),o.interceptors.request.use(function(e){return function(t){var r=(0,l.b)(e);if(r){var n=r.type,o=r.value;return O(t,{authorization:"".concat(n,":").concat(o)})}return t}}(e)),o.interceptors.request.use(function(e){return function(t){return O(t,{"x-alamy-session":e.get("Session")})}}(e)),o.interceptors.request.use(w),o},k=function(){var e=(0,o.Z)(c().mark((function e(t,r){var o,u,a,i,p,l,d,v;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=null===r||void 0===r||null===(o=r.headers)||void 0===o?void 0:o["x-correlation-id"],a=u?u.toString():(0,s.Z)(),i=x(t,a),e.next=5,f();case 5:return p=e.sent,l=(0,n.Z)(p,2),d=l[0],v=l[1],i.defaults.httpAgent=d,i.defaults.httpsAgent=v,i.interceptors.request.use(P(r)),e.abrupt("return",Promise.resolve(i));case 13:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},34118:function(e,t,r){r.d(t,{b:function(){return c}});var n=r(83109),o=/^\{(.*)\}$/,u=function(e){var t=e&&o.exec(e);return t&&t[1]||e},c=function(e){var t=e.get(n.AuthTokenType.Hard),r=e.get(n.AuthTokenType.HardBound),o=u(e.get(n.AuthTokenType.Soft)),c=u(e.get(n.AuthTokenType.Guest));return t?{type:n.AuthTokenType.Hard,value:t}:r?{type:n.AuthTokenType.HardBound,value:r}:o?{type:n.AuthTokenType.Soft,value:o}:c?{type:n.AuthTokenType.Guest,value:c}:null}},24308:function(e,t,r){r.d(t,{CI:function(){return p},hl:function(){return f},SQ:function(){return l},QR:function(){return d},SM:function(){return i}});var n=r(92809),o=r(76489),u=r(4367);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var i="Currency",s={secure:!0,path:"/"},p=function(e,t,r,n){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=a(a({},s),c);n?e.set(r,n,i):e.remove(r,i),t&&(0,u.eJ)(t,"Set-Cookie",(0,o.q)(r,n,i))},f=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return p(e,t,r,"",a(a(a({},s),n),{},{expires:new Date(0)}))},l=function(e){var t=e.getAll();return Object.keys(t).map((function(e){return"".concat(e,"=").concat(t[e])})).join("; ")},d=function(e){var t=e.split(".");return t.splice(t.length-2).join(".").split(":")[0]}},44555:function(e,t,r){r.d(t,{u:function(){return j},a:function(){return P}});var n=r(61565),o=r(30266),u=r(809),c=r.n(u),a=r(25501),i=r(28996),s=r(98284),p=r(89584),f=r(34629),l=r(14464),d=r(56778),v=r(40370),b=r(34118),y=r(24308),O=r(485),h=r(92809);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){(0,h.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var j=function(){var e=(0,o.Z)(c().mark((function e(t,r,o,u,a){var i,s,v,b,y,O,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([(0,d.r)(t)(),o?(0,l.RK)(t)():[],o?(0,p.dv)(t)():{count:0},o&&null!==r&&void 0!==r&&null!==(i=r.user)&&void 0!==i&&i.isIQUser?(0,f.S)(t)(1,u):null]);case 2:return s=e.sent,v=(0,n.Z)(s,4),b=v[0],y=v[1],O=v[2],h=v[3],e.abrupt("return",{props:{pageData:{layoutData:b,authInfo:r,lightboxes:y,cart:O,licences:h,cookieDomain:a}}});case 9:case"end":return e.stop()}}),e)})));return function(t,r,n,o,u){return e.apply(this,arguments)}}(),P=function(e){var t=e.addContext,r=e.getInitialProps,n=e.getFinalProps;return function(e){var u=function(){var u=(0,o.Z)(c().mark((function o(u){var a,i,s,p,f,l;return c().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,t(u);case 2:return a=o.sent,i=w(w({},u),a),o.next=6,r(i);case 6:if(!("redirect"in(s=o.sent))&&!("notFound"in s)){o.next=9;break}return o.abrupt("return",s);case 9:return o.next=11,e(i);case 11:if(!("redirect"in(p=o.sent))&&!("notFound"in p)){o.next=14;break}return o.abrupt("return",p);case 14:return f=s.props,o.next=17,n(w(w({},i),{},{initialProps:f}));case 17:if(!("redirect"in(l=o.sent))&&!("notFound"in l)){o.next=20;break}return o.abrupt("return",l);case 20:return o.abrupt("return",{props:w(w(w({},s.props),p.props),l.props)});case 21:case"end":return o.stop()}}),o)})));return function(e){return u.apply(this,arguments)}}();return u.inner=e,u}}({addContext:function(){var e=(0,o.Z)(c().mark((function e(t){var r,n,o,u,p,f,l,d,h,g,w,j;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.req,n=t.res,o=t.locale,u=new a.Z(r.headers.cookie),p=(0,y.QR)(r.headers.host||""),e.next=5,(0,v.yx)(u,r);case 5:return f=e.sent,l=o||i.a,d=r.headers["user-agent"]||"",h=(0,O.CA)(d),g=Boolean((0,b.b)(u)),e.next=12,(0,s.yr)(f)(u,n,l,p,h);case 12:return w=e.sent,j=r.headers.referer,e.abrupt("return",{cookies:u,api:f,locale:l,isBot:h,authInfo:w,isAuthenticatedRequest:g,cookieDomain:p,referer:j});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getInitialProps:function(e){var t=e.api,r=e.authInfo,n=e.isAuthenticatedRequest,o=e.locale,u=e.cookieDomain;return j(t,r,n,o,u)},getFinalProps:function(e){var t=e.cookies;return Promise.resolve({props:{cookie:(0,y.SQ)(t)}})}})},72782:function(e,t,r){r.d(t,{M:function(){return p}});var n=r(92809),o=r(25501),u=r(44410),c=r(44555),a=r(85893);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e){var t=e.render,r=e.getPageProps,n=e.isStaticRender,i=void 0!==n&&n,p=t,f=function(e){var t,r,n,c,i=new o.Z(e.cookie),f=s(s({},e),{},{cookiesItem:i}),l=null===e||void 0===e||null===(t=e.pageData)||void 0===t||null===(r=t.authInfo)||void 0===r||null===(n=r.user)||void 0===n?void 0:n.audienceType;!i.get("AudienceType")&&l&&i.set("AudienceType",l,{domain:null===e||void 0===e||null===(c=e.pageData)||void 0===c?void 0:c.cookieDomain,path:"/"});return(0,a.jsx)(u.Z,{cookies:i,children:(0,a.jsx)(p,s({},f))})};return f.inner=t,!i&&r?{Page:f,getServerSideProps:(0,c.a)(r)}:{Page:f}}},4367:function(e,t,r){r.d(t,{eJ:function(){return a},ct:function(){return i}});var n=r(86818),o=r(56647),u=r(45922),c=function(e,t){var r=e.getHeader(t);return r instanceof Array?r:r?[String(r)]:[]},a=function(e,t,r){var o=c(e,t);e.setHeader(t,o.length?[].concat((0,n.Z)(c(e,t)),[r]):r)},i=function(e,t,r){return r&&(0,u.S3)(r),t===o.W.NOT_FOUND?{notFound:!0}:(e.statusCode=t,{props:{errorCode:t}})}}}]);